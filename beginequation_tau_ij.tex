\begin{equation}
\tau_{i\,j} = \frac{ 1 + z_i}{c} \frac{D_i D_j}{D_{i\,j}}.
\end{equation}
Note that each main plane needs to be evaluated using the positions $\vx_\ell$, which are not generally the same as the positions $\vx_1$ on the sky and must be computed with the lens equation. This distinction gives rise to non-linearities that cannot be mimicked by a simple shear, which is an extension of the single foreground case discussed in Section \ref{subsec:foreground}. Our framework is efficient because the recursive sums only include main planes, but is more accurate than fitting a single simple shear. All of the shear planes---which may number in the hundreds for realistic lines of sight---can be compressed into the following matrices: